---
title: "Processing a K2GWB file"
output:
  html_vignette:
    mathjax: null
vignette: >
  %\VignetteIndexEntry{Processing a K2GWB file}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
bibliography: logKcalc.bib
csl: elementa.csl
---

<!-- https://gomakethings.com/how-to-break-an-image-out-of-its-parent-container-with-css/ -->
<style>
@media (min-width: 700px) {
  .full-width {
    left: 50%;
    margin-left: -50vw;
    margin-right: -50vw;
    max-width: 100vw;
    position: relative;
    right: 50%;
    width: 100vw;
  }
}
@media (min-width: 1020px) {
  .full-width {
    left: 50vw; /* fallback if needed */
    left: calc(50vw - 160px);
    width: 1000px;
    position: relative;
    background-color: #9ecff7;
    padding:10px;
  }
}
</style>

```{r setup, include=FALSE}
library(logKcalc)
library(knitr)
## colorize messages 20171031
## adapted from https://gist.github.com/yihui/2629886#file-knitr-color-msg-rnw
color_block = function(color) {
  function(x, options) sprintf('<pre style="color:%s">%s</pre>', color, x)
}
knit_hooks$set(warning = color_block('magenta'), error = color_block('red'), message = color_block('blue'))
```

#### This vignette shows the results from processing a GWB data file created by K2GWB [@CB05].

```{r logKcalc}
infile <- system.file("extdata/ThermoGWB_15_6_2020.tdat", package = "logKcalc")
outfile <- file.path(tempdir(), "ThermoGWB_OBIGT.tdat")
modOBIGT(c("addSUPCRT", "steam", "realgar*4"))
logKcalc(infile, outfile)
```

#### Now we can make some plots to compare the logK values in the input and output files.

Labels are added to points with a difference of greater that 1 log*K* unit.

```{r logKcomp, message = FALSE, results = "hide", fig.width = 12, fig.height = 6, out.width = "100%", out.extra='class="full-width"'}
plot1 <- logKcomp(infile, outfile, lab1 = "UNITHERM", lab2 = "OBIGT")
plot2 <- logKcomp(infile, outfile, type = "mineral", lab1 = "UNITHERM", lab2 = "OBIGT")
gridExtra::grid.arrange(plot1, plot2, ncol = 2)
```

These plots were made with **logKcalc** version `r packageDescription("logKcalc")$Version` and **CHNOSZ** version `r packageDescription("CHNOSZ")$Version`.

## References
